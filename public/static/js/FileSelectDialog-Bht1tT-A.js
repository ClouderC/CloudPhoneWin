var h=(g,_,l)=>new Promise((r,o)=>{var p=t=>{try{a(l.next(t))}catch(i){o(i)}},u=t=>{try{a(l.throw(t))}catch(i){o(i)}},a=t=>t.done?r(t.value):Promise.resolve(t.value).then(p,u);a((l=l.apply(g,_)).next())});import{g as k}from"./file-BLpzX1t2.js";import{v as A,c as L,r as w,A as M,o as R,U as y,q as F,R as c,F as U,ae as q,D as m,H as d,S as x,Q as B,a8 as D,_ as E}from"./index-DqYxAufE.js";const G=A({name:"FileSelectDialog",__name:"FileSelectDialog",props:{visible:{type:Boolean}},emits:["update:visible","select"],setup(g,{expose:_,emit:l}){const r=g,o=l,p=L({get:()=>r.visible,set:e=>o("update:visible",e)}),u=w([]),a=w(!1),t=()=>h(null,null,function*(){try{a.value=!0;const e=yield k({page:1,pageSize:100,originalName:""});e.code===0?u.value=[...e.data.list].sort((f,s)=>{const v=new Date(f.updatedAt||0).getTime();return new Date(s.updatedAt||0).getTime()-v}):D.error(e.message||"获取文件列表失败")}catch(e){console.error("获取文件列表出错:",e),D.error("获取文件列表出错")}finally{a.value=!1}});M(()=>r.visible,e=>{e&&t()});const i=()=>{o("update:visible",!1)},S=e=>{o("select",e),i()},T=e=>e<1024?e+"B":e<1024*1024?(e/1024).toFixed(2)+"KB":e<1024*1024*1024?(e/(1024*1024)).toFixed(2)+"MB":(e/(1024*1024*1024)).toFixed(2)+"GB",C=e=>{switch(e){case"image":return"success";case"document":return"primary";case"video":return"warning";case"audio":return"info";case"archive":return"danger";case"app":return"warning";default:return"info"}};return R(()=>{r.visible&&t()}),_({refresh:t}),(e,f)=>{const s=m("el-table-column"),v=m("el-tag"),b=m("el-table"),V=m("el-dialog"),N=q("loading");return F(),y(V,{modelValue:p.value,"onUpdate:modelValue":f[0]||(f[0]=n=>p.value=n),title:"选择要推送的文件",width:"600px","close-on-click-modal":!1,onClose:i},{default:c(()=>[U((F(),y(b,{data:u.value,style:{width:"100%"},height:"400",onRowClick:S},{default:c(()=>[d(s,{prop:"fileName",label:"文件名称",width:"180"}),d(s,{prop:"originalName",label:"原始文件名",width:"180"}),d(s,{label:"大小",width:"100"},{default:c(({row:n})=>[x(B(T(n.fileSize)),1)]),_:1}),d(s,{prop:"fileType",label:"类型",width:"100"},{default:c(({row:n})=>[d(v,{type:C(n.fileType)},{default:c(()=>[x(B(n.fileType||"未知"),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])),[[N,a.value]])]),_:1},8,["modelValue"])}}}),Q=E(G,[["__scopeId","data-v-18536754"]]);export{Q as default};
