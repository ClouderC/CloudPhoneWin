var ne=Object.defineProperty;var F=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var M=(m,u,d)=>u in m?ne(m,u,{enumerable:!0,configurable:!0,writable:!0,value:d}):m[u]=d,N=(m,u)=>{for(var d in u||(u={}))de.call(u,d)&&M(m,d,u[d]);if(F)for(var d of F(u))se.call(u,d)&&M(m,d,u[d]);return m};var I=(m,u,d)=>new Promise((_,g)=>{var v=o=>{try{n(d.next(o))}catch(U){g(U)}},h=o=>{try{n(d.throw(o))}catch(U){g(U)}},n=o=>o.done?_(o.value):Promise.resolve(o.value).then(v,h);n((d=d.apply(m,u)).next())});import{g as ue,d as re,u as pe,c as ie}from"./permission-oQVXAKlj.js";import{v as me,r as w,e as T,o as fe,p as ce,q as C,H as e,R as t,F as q,D as s,S as i,ae as $,U as B,Q as z,G as A,a8 as k,aD as _e,_ as be}from"./index-DqYxAufE.js";const Ve={class:"main"},ge={class:"card-header"},ve=me({name:"SystemPermission",__name:"index",setup(m){const u=w(!1),d=w([]),_=w(!1),g=w(""),v=w(),h=w([]),n=T({name:"",code:"",type:"",status:null}),o=T({id:0,name:"",code:"",type:"menu",parentId:0,path:"",component:"",icon:"",sort:0,status:1,description:""}),U={name:[{required:!0,message:"请输入权限名称",trigger:"blur"}],code:[{required:!0,message:"请输入权限编码",trigger:"blur"}],type:[{required:!0,message:"请选择权限类型",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},D=()=>I(null,null,function*(){u.value=!0;try{const p=N({name:n.name,code:n.code,type:n.type},n.status!==null&&n.status!==""?{status:n.status}:{}),{data:l}=yield ue(p);d.value=l.list,h.value=[{id:0,name:"根节点",children:l.list}]}catch(p){k.error("获取权限列表失败")}finally{u.value=!1}}),E=()=>{D()},G=()=>{Object.assign(n,{name:"",code:"",type:"",status:null}),E()},H=()=>{g.value="新增权限",Object.assign(o,{id:0,name:"",code:"",type:"menu",parentId:0,path:"",component:"",icon:"",sort:0,status:1,description:""}),_.value=!0},L=p=>{g.value="编辑权限",Object.assign(o,p),_.value=!0},Q=p=>I(null,null,function*(){try{yield _e.confirm("确定要删除该权限吗？","提示",{type:"warning"}),yield re(p.id),k.success("删除成功"),D()}catch(l){l!=="cancel"&&k.error("删除失败")}}),J=()=>I(null,null,function*(){if(v.value)try{yield v.value.validate(),o.id?(yield pe(o.id,o),k.success("更新成功")):(yield ie(o),k.success("创建成功")),_.value=!1,D()}catch(p){k.error(o.id?"更新失败":"创建失败")}}),K=()=>{var p;(p=v.value)==null||p.resetFields()};return fe(()=>{D()}),(p,l)=>{const V=s("el-button"),b=s("el-input"),r=s("el-form-item"),y=s("el-option"),P=s("el-select"),O=s("el-form"),f=s("el-table-column"),R=s("el-tag"),W=s("el-button-group"),X=s("el-table"),Y=s("el-card"),c=s("el-col"),x=s("el-row"),Z=s("el-tree-select"),ee=s("el-input-number"),j=s("el-radio"),le=s("el-radio-group"),te=s("el-dialog"),S=$("perms"),ae=$("loading");return C(),ce("div",Ve,[e(Y,{shadow:"never"},{header:t(()=>[A("div",ge,[l[17]||(l[17]=A("span",null,"权限管理",-1)),q((C(),B(V,{onClick:H},{default:t(()=>l[16]||(l[16]=[i(" 新增权限 ")])),_:1})),[[S,["system:permission:add"]]])])]),default:t(()=>[e(O,{model:n,inline:"",class:"search-form"},{default:t(()=>[e(r,{label:"权限名称"},{default:t(()=>[e(b,{modelValue:n.name,"onUpdate:modelValue":l[0]||(l[0]=a=>n.name=a),placeholder:"请输入权限名称",clearable:""},null,8,["modelValue"])]),_:1}),e(r,{label:"权限编码"},{default:t(()=>[e(b,{modelValue:n.code,"onUpdate:modelValue":l[1]||(l[1]=a=>n.code=a),placeholder:"请输入权限编码",clearable:""},null,8,["modelValue"])]),_:1}),e(r,{label:"权限类型"},{default:t(()=>[e(P,{modelValue:n.type,"onUpdate:modelValue":l[2]||(l[2]=a=>n.type=a),placeholder:"请选择类型",clearable:"",style:{width:"120px"}},{default:t(()=>[e(y,{label:"菜单",value:"menu"}),e(y,{label:"按钮",value:"button"})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"状态"},{default:t(()=>[e(P,{modelValue:n.status,"onUpdate:modelValue":l[3]||(l[3]=a=>n.status=a),placeholder:"请选择状态",clearable:"",style:{width:"120px"}},{default:t(()=>[e(y,{label:"启用",value:1}),e(y,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1}),e(r,null,{default:t(()=>[e(V,{onClick:E},{default:t(()=>l[18]||(l[18]=[i("搜索")])),_:1}),e(V,{onClick:G},{default:t(()=>l[19]||(l[19]=[i("重置")])),_:1})]),_:1})]),_:1},8,["model"]),q((C(),B(X,{data:d.value,"row-key":"id",border:"","default-expand-all":"","tree-props":{children:"children"}},{default:t(()=>[e(f,{prop:"name",label:"权限名称",width:"180"}),e(f,{prop:"code",label:"权限编码",width:"180"}),e(f,{prop:"type",label:"类型",width:"80"},{default:t(({row:a})=>[e(R,{type:a.type==="menu"?"primary":"success",size:"small"},{default:t(()=>[i(z(a.type==="menu"?"菜单":"按钮"),1)]),_:2},1032,["type"])]),_:1}),e(f,{prop:"path",label:"路由路径",width:"120","show-overflow-tooltip":""}),e(f,{prop:"icon",label:"图标",width:"80"}),e(f,{prop:"sort",label:"排序",width:"60"}),e(f,{prop:"status",label:"状态",width:"80"},{default:t(({row:a})=>[e(R,{type:a.status===1?"success":"danger",size:"small"},{default:t(()=>[i(z(a.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),e(f,{prop:"description",label:"描述","min-width":"150","show-overflow-tooltip":""}),e(f,{label:"操作",width:"120"},{default:t(({row:a})=>[e(W,null,{default:t(()=>[q((C(),B(V,{type:"primary",link:"",onClick:oe=>L(a)},{default:t(()=>l[20]||(l[20]=[i(" 编辑 ")])),_:2},1032,["onClick"])),[[S,["system:permission:edit"]]]),q((C(),B(V,{type:"danger",link:"",onClick:oe=>Q(a)},{default:t(()=>l[21]||(l[21]=[i(" 删除 ")])),_:2},1032,["onClick"])),[[S,["system:permission:delete"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ae,u.value]])]),_:1}),e(te,{modelValue:_.value,"onUpdate:modelValue":l[15]||(l[15]=a=>_.value=a),title:g.value,width:"800px",onClose:K},{footer:t(()=>[e(V,{onClick:l[14]||(l[14]=a=>_.value=!1)},{default:t(()=>l[24]||(l[24]=[i("取消")])),_:1}),e(V,{onClick:J},{default:t(()=>l[25]||(l[25]=[i("确定")])),_:1})]),default:t(()=>[e(O,{ref_key:"formRef",ref:v,model:o,rules:U,"label-width":"120px"},{default:t(()=>[e(x,{gutter:20},{default:t(()=>[e(c,{span:12},{default:t(()=>[e(r,{label:"权限名称",prop:"name"},{default:t(()=>[e(b,{modelValue:o.name,"onUpdate:modelValue":l[4]||(l[4]=a=>o.name=a),placeholder:"请输入权限名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:t(()=>[e(r,{label:"权限编码",prop:"code"},{default:t(()=>[e(b,{modelValue:o.code,"onUpdate:modelValue":l[5]||(l[5]=a=>o.code=a),placeholder:"请输入权限编码"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,{gutter:20},{default:t(()=>[e(c,{span:12},{default:t(()=>[e(r,{label:"权限类型",prop:"type"},{default:t(()=>[e(P,{modelValue:o.type,"onUpdate:modelValue":l[6]||(l[6]=a=>o.type=a),placeholder:"请选择类型",style:{width:"100%"}},{default:t(()=>[e(y,{label:"菜单",value:"menu"}),e(y,{label:"按钮",value:"button"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:t(()=>[e(r,{label:"父级权限",prop:"parentId"},{default:t(()=>[e(Z,{modelValue:o.parentId,"onUpdate:modelValue":l[7]||(l[7]=a=>o.parentId=a),data:h.value,props:{children:"children",label:"name",value:"id"},placeholder:"请选择父级权限",clearable:"","check-strictly":""},null,8,["modelValue","data"])]),_:1})]),_:1})]),_:1}),e(x,{gutter:20},{default:t(()=>[e(c,{span:12},{default:t(()=>[e(r,{label:"路由路径",prop:"path"},{default:t(()=>[e(b,{modelValue:o.path,"onUpdate:modelValue":l[8]||(l[8]=a=>o.path=a),placeholder:"请输入路由路径"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:t(()=>[e(r,{label:"组件路径",prop:"component"},{default:t(()=>[e(b,{modelValue:o.component,"onUpdate:modelValue":l[9]||(l[9]=a=>o.component=a),placeholder:"请输入组件路径"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,{gutter:20},{default:t(()=>[e(c,{span:12},{default:t(()=>[e(r,{label:"图标",prop:"icon"},{default:t(()=>[e(b,{modelValue:o.icon,"onUpdate:modelValue":l[10]||(l[10]=a=>o.icon=a),placeholder:"请输入图标"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:t(()=>[e(r,{label:"排序",prop:"sort"},{default:t(()=>[e(ee,{modelValue:o.sort,"onUpdate:modelValue":l[11]||(l[11]=a=>o.sort=a),min:0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,{gutter:20},{default:t(()=>[e(c,{span:12},{default:t(()=>[e(r,{label:"状态",prop:"status"},{default:t(()=>[e(le,{modelValue:o.status,"onUpdate:modelValue":l[12]||(l[12]=a=>o.status=a)},{default:t(()=>[e(j,{label:1},{default:t(()=>l[22]||(l[22]=[i("启用")])),_:1}),e(j,{label:0},{default:t(()=>l[23]||(l[23]=[i("禁用")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{label:"描述",prop:"description"},{default:t(()=>[e(b,{modelValue:o.description,"onUpdate:modelValue":l[13]||(l[13]=a=>o.description=a),type:"textarea",rows:3,placeholder:"请输入描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Ue=be(ve,[["__scopeId","data-v-9f96d2ee"]]);export{Ue as default};
