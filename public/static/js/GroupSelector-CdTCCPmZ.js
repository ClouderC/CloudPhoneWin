var y=(_,v,t)=>new Promise((u,n)=>{var c=r=>{try{e(t.next(r))}catch(p){n(p)}},m=r=>{try{e(t.throw(r))}catch(p){n(p)}},e=r=>r.done?u(r.value):Promise.resolve(r.value).then(c,m);e((t=t.apply(_,v)).next())});import{g as N}from"./group-C52rk5Pr.js";import{v as z,r as g,e as D,A as W,o as E,a8 as b,D as i,U as I,q as x,R as s,H as d,p as F,K as M,L as R,G as f,Q as w,S as C,_ as q}from"./index-DqYxAufE.js";const A={style:{float:"right",color:"#8492a6","font-size":"13px"}},H={class:"dialog-footer"},K=z({__name:"GroupSelector",props:{title:{default:"选择分组"},visible:{type:Boolean},maxWorker:{default:50}},emits:["update:visible","confirm","cancel"],setup(_,{emit:v}){const t=_,u=v,n=g(t.visible),c=g([]),m=g(!1),e=D({groupId:0,maxWorker:t.maxWorker});W(()=>t.visible,o=>{n.value=o,o&&(r(),e.groupId=0,e.maxWorker=t.maxWorker)}),W(n,o=>{u("update:visible",o)}),E(()=>{n.value=t.visible,t.visible&&r()});const r=()=>y(null,null,function*(){m.value=!0;try{const o=yield N({page:1,pageSize:1e3});o.code===0&&o.data?c.value=o.data.list||[]:b.error(o.message||"获取分组列表失败")}catch(o){console.error("获取分组列表出错:",o),b.error("获取分组列表出错")}finally{m.value=!1}}),p=()=>{if(!e.groupId){b.warning("请选择分组");return}u("confirm",{groupId:e.groupId,maxWorker:e.maxWorker})},B=()=>{n.value=!1,u("update:visible",!1),u("cancel")};return(o,l)=>{const G=i("el-option"),L=i("el-select"),k=i("el-form-item"),S=i("el-input-number"),h=i("el-form"),V=i("el-button"),U=i("el-dialog");return x(),I(U,{modelValue:n.value,"onUpdate:modelValue":l[2]||(l[2]=a=>n.value=a),title:o.title,width:"500px"},{footer:s(()=>[f("span",H,[d(V,{onClick:B},{default:s(()=>l[4]||(l[4]=[C("取消")])),_:1}),d(V,{type:"primary",onClick:p,loading:m.value},{default:s(()=>l[5]||(l[5]=[C(" 确认 ")])),_:1},8,["loading"])])]),default:s(()=>[d(h,{ref:"groupFormRef",model:e,"label-width":"100px"},{default:s(()=>[d(k,{label:"选择分组",prop:"groupId"},{default:s(()=>[d(L,{modelValue:e.groupId,"onUpdate:modelValue":l[0]||(l[0]=a=>e.groupId=a),placeholder:"请选择分组",style:{width:"100%"}},{default:s(()=>[(x(!0),F(M,null,R(c.value,a=>(x(),I(G,{key:a.id,label:a.name,value:a.id},{default:s(()=>[f("span",null,w(a.name),1),f("span",A," ("+w(a.deviceCount)+"台设备) ",1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),d(k,{label:"并发数",prop:"maxWorker"},{default:s(()=>[d(S,{modelValue:e.maxWorker,"onUpdate:modelValue":l[1]||(l[1]=a=>e.maxWorker=a),min:1,max:100,placeholder:"请输入并发数",style:{width:"100%"}},null,8,["modelValue"]),l[3]||(l[3]=f("div",{class:"form-tip"}," 并发数表示同时处理的设备数量，建议设置在 1-20 之间，过大的并发数会被服务器自动调整 ",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),J=q(K,[["__scopeId","data-v-0e4cb1c8"]]);export{J as default};
