var w=(y,l,a)=>new Promise((t,d)=>{var n=e=>{try{i(a.next(e))}catch(u){d(u)}},v=e=>{try{i(a.throw(e))}catch(u){d(u)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,v);i((a=a.apply(y,l)).next())});import{_ as x,i as D,u as I,r as p,c as $,o as B,C as E,D as g,p as _,q as f,G as r,Q as b,P as R,H as C,R as S,S as N,a8 as m}from"./index-DqYxAufE.js";const q={class:"device-detail-container"},L={class:"device-header"},M={class:"device-info"},V={class:"actions"},z={class:"device-content"},T=["src"],G={key:1,class:"offline-message"},H={__name:"detail",setup(y){const l=D(),a=I(),t=p(""),d=p("加载中..."),n=p("offline"),v="/scrcpy",i="/scrcpy_ws",e=c=>{const s=c.data;if(s&&s.type==="screenshot"&&s.data)try{const o=document.createElement("a");o.href=s.data.imageUrl,o.download=s.data.filename||`设备截图_${new Date().toLocaleString()}.png`,document.body.appendChild(o),o.click(),setTimeout(()=>{document.body.removeChild(o)},100),m.success("截图已保存")}catch(o){console.error("保存截图失败:",o),m.error("截图保存失败: "+o.message)}},u=$(()=>{if(!t.value)return"about:blank";const c=encodeURIComponent(t.value),s=encodeURIComponent(`${i}/?action=proxy-adb&remote=tcp:8886&udid=${t.value}`);return`${v}/#!action=stream&udid=${c}&player=webcodecs&ws=${s}`}),k=()=>w(null,null,function*(){try{t.value=l.params.id||"",d.value=l.query.name||t.value,n.value=l.query.status||"offline",t.value||(m.error("设备ID不能为空"),h())}catch(c){console.error("获取设备详情失败:",c),m.error("获取设备详情失败")}}),h=()=>{a.push("/device/cloudphone")};return B(()=>{k(),window.addEventListener("message",e)}),E(()=>{window.removeEventListener("message",e)}),(c,s)=>{const o=g("el-button"),U=g("el-empty");return f(),_("div",q,[r("div",L,[r("div",M,[r("h2",null,b(d.value),1),r("div",{class:R(["device-status",{online:n.value==="online"}])},b(n.value==="online"?"在线":"离线"),3)]),r("div",V,[C(o,{type:"primary",size:"small",onClick:h},{default:S(()=>s[0]||(s[0]=[N("返回")])),_:1})])]),r("div",z,[n.value==="online"?(f(),_("iframe",{key:0,src:u.value,class:"device-stream",frameborder:"0",allowfullscreen:"",sandbox:"allow-scripts allow-same-origin allow-forms allow-downloads"},null,8,T)):(f(),_("div",G,[C(U,{description:"设备当前离线，无法显示控制界面"})]))])])}}},j=x(H,[["__scopeId","data-v-7b645a98"]]);export{j as default};
